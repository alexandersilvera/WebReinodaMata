import{u as f,d as E,b,g as v}from"./config.DlMdeYpO.js";import"./hoisted.D3FFN0QM.js";const a=document.getElementById("loading"),m=document.getElementById("confirm-form"),o=document.getElementById("success"),c=document.getElementById("error"),i=document.getElementById("error-message"),s=document.getElementById("invalid-link"),u=new URLSearchParams(window.location.search),d=u.get("id"),l=u.get("email"),r=e=>{[a,m,o,c,s].forEach(t=>{t&&t.classList.add("hidden")}),e&&e.classList.remove("hidden")},g=async()=>{if(!d||!l)return r(s),{valid:!1};try{const e=E(b,"subscribers",d),t=await v(e);if(!t.exists())return r(s),{valid:!1};const n=t.data();return n.email!==l?(r(s),{valid:!1}):n.active===!1?(r(o),{valid:!1}):{valid:!0,subscriberRef:e}}catch(e){return console.error("Error al verificar suscripci칩n:",e),r(c),{valid:!1}}},y=async()=>{try{r(a);const{valid:e,subscriberRef:t}=await g();if(!e)return;r(m),document.getElementById("confirm-btn")?.addEventListener("click",async()=>{try{r(a),await f(t,{active:!1}),r(o)}catch(n){console.error("Error al cancelar suscripci칩n:",n),i&&(i.textContent="No pudimos cancelar tu suscripci칩n. Por favor, intenta de nuevo m치s tarde."),r(c)}}),document.getElementById("cancel-btn")?.addEventListener("click",()=>{window.location.href="/"})}catch(e){console.error("Error general:",e),r(c)}};document.addEventListener("DOMContentLoaded",y);
