const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/hoisted.D3FFN0QM.js","_astro/config.DlMdeYpO.js"])))=>i.map(i=>d[i]);
import{_ as u}from"./preload-helper.CLcXU_4U.js";import{i as d,b as s,n as m,d as p,u as w,T as h,k as y,q as E,w as b}from"./config.DlMdeYpO.js";const c="subscribers",D=async o=>{try{if(await _(o.email))throw new Error("El correo electrónico ya está registrado");return(await y(d(s,c),{...o,createdAt:h.now(),active:!0})).id}catch(r){throw console.error("Error al añadir suscriptor:",r),r}},_=async o=>{try{const r=E(d(s,c),b("email","==",o));return!(await m(r)).empty}catch(r){throw console.error("Error al verificar email:",r),r}},R=async(o=!1)=>{try{const r=d(s,c);return(await m(r)).docs.map(t=>({id:t.id,...t.data()})).filter(t=>o?!0:!t.deleted).sort((t,a)=>{const n=t.createdAt?.toDate?.()||new Date(0);return(a.createdAt?.toDate?.()||new Date(0)).getTime()-n.getTime()})}catch(r){throw console.error("Error al obtener suscriptores:",r),r}},v=async(o,r)=>{try{const e=p(s,c,o);await w(e,{active:r})}catch(e){throw console.error("Error al actualizar suscriptor:",e),e&&typeof e=="object"&&"code"in e&&(console.error("Código de error:",e.code),console.error("Mensaje de error:",e.message)),e}},C=async o=>{try{const{auth:r,functions:e}=await u(async()=>{const{auth:i,functions:l}=await import("./config.DlMdeYpO.js").then(f=>f.C);return{auth:i,functions:l}},[]),{httpsCallable:t}=await u(async()=>{const{httpsCallable:i}=await import("./hoisted.D3FFN0QM.js").then(l=>l.i);return{httpsCallable:i}},__vite__mapDeps([0,1])),a=r.currentUser;if(!a)throw new Error("Usuario no autenticado. Debes iniciar sesión para realizar esta acción.");if(console.log("Intentando eliminar suscriptor con ID:",o),console.log("Usuario autenticado:",a.email),a.email!=="alexandersilvera@hotmail.com")throw new Error("No tienes permisos para eliminar suscriptores. Esta acción está reservada para administradores.");const n=p(s,c,o);await w(n,{active:!1,deleted:!0,deletedAt:h.now()}),console.log("Suscriptor marcado como eliminado correctamente")}catch(r){throw console.error("Error al eliminar suscriptor:",r),r.code&&(console.error("Código de error:",r.code),console.error("Mensaje de error:",r.message)),r}};export{D as a,C as d,R as g,v as u};
